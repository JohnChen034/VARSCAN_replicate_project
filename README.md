# Vcall

 We build a variant calling tool specifically on SNPs, and could expand to more later. Use `Vcallsnp` to perform variant calling on SNPs.

## Installation instructions

Installation requires `pandas` to be installed. You can install it using pip: 
``` 
pip install pandas 
```
Installation requires `numpy` to be installed. You can install it using pip: 
``` 
pip install numpy 
```
Installation requires `scipy` to be installed. You can install it using pip: 
``` 
pip install scipy
```
Once you have all packages installed, please download the Vcall folder and the setup.py file and put the setup.py in the same directory with the Vcall fole, then open a terminal and cd to the directory. Finally, you can install `Vcall` using pip: 
```
pip install .
```

note: detailed version is in `requirements.txt`. 

## Basic Usage

usage: 
```
Vcallsnp [-h] [-mvf MINVARFREQ] [-mc MINCOVERAGE] [-mr MINREADS] [-maq MINAVGQUAL] [-mffh MINFREQFORHOM] [-p PVALUE] [-sf STRANDFILTER] [-out OUTPATH] [-f FILENAME] MPILEUPFILE
```

To run mypileup on a small test example (using files in this repo):

```
Vcallsnp ./test/trio.mpileup -mvf 0.2 -mffh 0.8 -p 0.01 -f filename
```


## Options

positional arguments:

  - `MPILEUPFILE`       path to the input mpileup file


  - `-op OUTPATH`, `--out-path OUTPATH`
                        Specify the output path (default: current working directory)


  - `-o OUTPUT`, `--output OUTPUT`
                        Specify the output file name (default: output)  

optional arguments:

  - `-h`,` --help`            show this help message and exit


  - `-mvf MINVARFREQ`, `--min-var-freq MINVARFREQ`
                        minimum frequency threshold for variants (default: 0.2)


  - `-mc MINCOVERAGE`, `--min-coverage MINCOVERAGE`
                        Minimum read depth at a position to make a call (default: 8)


  - `-mr MINREADS`, `--min-reads MINREADS`
                        Minimum supporting reads at a position to call variants (default: 2)


  - `-maq MINAVGQUAL`, `--min-avg-qual MINAVGQUAL`
                        Minimum base quality at a position to count a read (default: 15)


  - `-mffh MINFREQFORHOM`, `--min-freq-for-hom MINFREQFORHOM`
                        Minimum frequency to call homozygote (default: 0.75)


  - `-p PVALUE`, `--p-value PVALUE`
                        p-value threshold for calling variants (default: 0.99)


  - `-sf STRANDFILTER`, `--strand-filter STRANDFILTER`
                        Ignore variants with more than 90 percent support on one strand (default: True)



## File format

The input file format is [`mpileup`](http://www.htslib.org/doc/samtools-mpileup.html), generated by [samtools](http://www.htslib.org/) using `bam` file.

The output file will be in [`VCF`](https://samtools.github.io/hts-specs/VCFv4.2.pdf).

## Contributors:

Kaifu Yang and Jiayu Chen developed this tool, with inspiration from [VarScan](https://varscan.sourceforge.net/) and lab1 from CSE 185 at UCSD.

Email for questions regarding the tool:

Kaifu Yang: kay002@ucsd.edu

Jiayu Chen: jic034@ucsd.edu
